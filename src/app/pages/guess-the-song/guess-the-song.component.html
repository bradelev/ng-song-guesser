<div class="flex flex-col items-center justify-center mb-6" *ngIf="vm$ | async as vm">
  <div class="w-full max-w-xl mx-auto">

    <p *ngIf="vm.selectedTeam as team" class="my-5 text-center">
      Your team is <strong>{{ team.name }}</strong>
    </p>

    <div class="text-center mb-4">
      <p>Attempts: {{ attempts }} / 3</p>
      <p>Played Games: {{ playedGames }}</p>
      <p>Total Score: {{ totalScore }}</p>
    </div>

    <form [formGroup]="songsForm" (ngSubmit)="onSubmit()"
      [ngClass]="{'opacity-50': isGameOver, 'cursor-not-allowed': isGameOver}"
      class="bg-white shadow-md rounded px-8 pt-6 pb-8 text-black">
      <div class="mb-6">
        <div *ngIf="(currentPhrase$ | async) as currentPhrase; else loading">
          <span class="font-bold">{{ currentPhrase }}</span>
        </div>
        <ng-template #loading>
          <div>Loading...</div>
        </ng-template>
      </div>
      <div class="flex flex-col">

        <div class="radio mb-2" *ngFor="let song of (songs$ | async)">
          <input
            hidden="hidden"
            type="radio"
            formControlName="songChoice"
            [id]="'song-' + song.songId"
            [value]="song.songId"
            [disabled]="isGameOver"
          />
          <label
            [class.pointer-events-none]="isGameOver"
            [for]="'song-' + song.songId"
            class="px-2 py-1 rounded-lg flex justify-center items-center font-bold w-full h-10 lg:h-14 hover:cursor-pointer"
          >
          {{ song.title }}
          </label>
        </div>
      </div>

      <div class="flex items-stretch flex-col justify-between pt-4">
        <app-button
          [isDisabled]="!!(stopCondition$ | async) || isGameOver"
          [inputType]="'submit'"
          [value]="'Guess'"
          [classes]="'w-full'"
        ></app-button>
      </div>
    </form>

    <div class="w-full h-4 mt-4">
      <ng-container *ngIf="timer$ | async as timer">
        <div *ngIf="timer > 0 && !isGameOver; else timesUp" id="countdown">
          <div id="countdown-number">{{ timer }}</div>
          <svg class="active">
            <circle r="18" cx="20" cy="20"></circle>
          </svg>
        </div>
        <ng-template #timesUp>
          <div class="text-center">
            <span *ngIf="!isGameOver" class="font-bold">Time's up!</span>
            <span *ngIf="isGameOver" class="font-bold">Game Over</span>
          </div>
        </ng-template>
      </ng-container>
    </div>

  </div>
</div>
