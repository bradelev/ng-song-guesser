"use strict";(self.webpackChunkng_song_guesser=self.webpackChunkng_song_guesser||[]).push([[813],{8813:(O,h,e)=>{e.r(h),e.d(h,{GuessTheSongComponent:()=>F});var r=e(6895),n=e(8256),l=e(433),T=e(7803),Z=e(1135),d=e(5698),u=e(4004),c=e(4049),y=e(9751),I=e(3532);function m(t=0,i=c.z){return t<0&&(t=0),function x(t=0,i,o=c.P){let s=-1;return null!=i&&((0,I.K)(i)?o=i:s=i),new y.y(g=>{let a=function $(t){return t instanceof Date&&!isNaN(t)}(t)?+t-o.now():t;a<0&&(a=0);let v=0;return o.schedule(function(){g.closed||(g.next(v++),0<=s?this.schedule(void 0,s):g.complete())},a)})}(t,t,i)}var p=e(2529),A=e(8675),M=e(3900),G=e(6270),J=e(42);function U(t,i){if(1&t&&(n.TgZ(0,"div")(1,"span",12),n._uU(2),n.qZA()()),2&t){const o=i.ngIf;n.xp6(2),n.Oqu(o)}}function b(t,i){1&t&&(n.TgZ(0,"div"),n._uU(1,"Loading..."),n.qZA())}function L(t,i){if(1&t&&(n.TgZ(0,"div"),n._UZ(1,"input",13),n.TgZ(2,"label",14),n._uU(3),n.qZA()()),2&t){const o=i.$implicit;n.xp6(1),n.Q6J("value",o.songId)("id","song-"+o.songId),n.xp6(1),n.Q6J("for","song-"+o.songId),n.xp6(1),n.Oqu(o.title)}}const N=function(t){return{width:t}};let F=(()=>{class t{constructor(){this._route=(0,n.f3M)(T.gz),this._songsService=(0,n.f3M)(G.e),this._fb=(0,n.f3M)(l.qu),this.randomSongId=Math.floor(8*Math.random())+1,this.lyrics$=this._getLyrics(this.randomSongId),this.stopCondition$=new Z.X(!1),this.songsForm=this._fb.group({songChoice:[null]}),this.songs$=this._songsService.getSongs().pipe((0,d.q)(1),(0,u.U)(o=>this._getSongOptions(o,this.randomSongId,3))),this.currentPhrase$=m(5e3).pipe((0,p.o)(()=>!this.stopCondition$.getValue()),(0,A.O)(0),(0,M.w)(()=>this.lyrics$),(0,u.U)(o=>o[Math.floor(Math.random()*o.length)])),this.countdown$=m(1e3).pipe((0,p.o)(()=>!this.stopCondition$.getValue()),(0,d.q)(30),(0,u.U)(o=>(o+1)/30*100))}onSubmit(){const o=this.songsForm.get("songChoice")?.value;Number(o)===this.randomSongId?(console.log("isCorrect -> ",this.randomSongId),this.stopCondition$.next(!0)):console.log("incorrect => ",Number(o),this.randomSongId)}_getLyrics(o){return this._songsService.getLyrics(o).pipe((0,u.U)(s=>this._shuffleArray(s)))}_getSongOptions(o,s,g){const S=o.filter(f=>f.songId!==s).sort(()=>Math.random()-.5).slice(0,g-1),C=o.find(f=>f.songId===s);return C&&S.push(C),S.sort(()=>Math.random()-.5)}_shuffleArray(o){for(let s=o.length-1;s>0;s--){const g=Math.floor(Math.random()*(s+1));[o[s],o[g]]=[o[g],o[s]]}return o}}return t.\u0275fac=function(o){return new(o||t)},t.\u0275cmp=n.Xpm({type:t,selectors:[["app-guess-the-song"]],standalone:!0,features:[n.jDz],decls:17,vars:18,consts:[[1,"min-h-screen","bg-gray-100","flex","items-center","justify-center"],[1,"w-full","max-w-md","mx-auto"],[1,"bg-white","shadow-md","rounded","px-8","pt-6","pb-8","mb-6",3,"formGroup","ngSubmit"],[1,"mb-6"],[4,"ngIf","ngIfElse"],["loading",""],[1,"flex","flex-col"],[4,"ngFor","ngForOf"],[1,"flex","items-center","justify-between","pt-4"],[3,"isDisabled","inputType","value"],[1,"w-full","h-4","bg-gray-300","mt-4"],[1,"h-4","bg-green-500","transition-all","duration-1000",3,"ngStyle"],[1,"font-bold"],["type","radio","formControlName","songChoice",1,"mr-2",3,"value","id"],[3,"for"]],template:function(o,s){if(1&o&&(n.TgZ(0,"div",0)(1,"div",1)(2,"form",2),n.NdJ("ngSubmit",function(){return s.onSubmit()}),n.TgZ(3,"div",3),n.YNc(4,U,3,1,"div",4),n.ALo(5,"async"),n.YNc(6,b,2,0,"ng-template",null,5,n.W1O),n.qZA(),n.TgZ(8,"div",6),n.YNc(9,L,4,4,"div",7),n.ALo(10,"async"),n.qZA(),n.TgZ(11,"div",8),n._UZ(12,"app-button",9),n.ALo(13,"async"),n.qZA(),n.TgZ(14,"div",10),n._UZ(15,"div",11),n.ALo(16,"async"),n.qZA()()()()),2&o){const g=n.MAs(7);n.xp6(2),n.Q6J("formGroup",s.songsForm),n.xp6(2),n.Q6J("ngIf",n.lcZ(5,8,s.currentPhrase$))("ngIfElse",g),n.xp6(5),n.Q6J("ngForOf",n.lcZ(10,10,s.songs$)),n.xp6(3),n.Q6J("isDisabled",!!n.lcZ(13,12,s.stopCondition$))("inputType","submit")("value","Guess"),n.xp6(3),n.Q6J("ngStyle",n.VKq(16,N,n.lcZ(16,14,s.countdown$)+"%"))}},dependencies:[r.ez,r.sg,r.O5,r.PC,r.Ov,J.r,l.UX,l._Y,l.Fj,l._,l.JJ,l.JL,l.sg,l.u]}),t})()}}]);